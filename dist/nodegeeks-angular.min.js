/*! nodegeeks-angular 01-01-2016 */
"use strict";angular.module("nodegeeks-angular",["ngSails"]).config(function(a){a.url="http://localhost:1337",a.debug=!0}),angular.module("nodegeeks-angular").controller("NodeGeeksController",function(){}),angular.module("nodegeeks-angular").factory("NodeGeeksModel",function(a){var b=a.Model();return b.define("nodegeeksmodel",{attributes:{}}),b}),angular.module("nodegeeks-angular").controller("AuthCtrl",function(a,b){a.login=b.login,a.signup=b.signup,a.social=b.social,a.recover=b.recover,a.logout=b.logout,a.validate=b.validate}),angular.module("nodegeeks-angular").controller("CountdownCtrl",function(a,b,c,d){}),angular.module("nodegeeks-angular").controller("SetupCtrl",function(a,b,c,d){a.app&&d.path("/"),b.setupApp=function(b){c.create(b).then(function(b){a.app=b,d.path("/")},function(a){alert(a.message)})}}),angular.module("nodegeeks-angular").directive("formWizardStepInput",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard-step-input.html",scope:{property:"=",label:"@",placeholder:"@",type:"@",col:"@"}}}),angular.module("nodegeeks-angular").directive("formWizardStep",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard-step.html",scope:{title:"@",number:"@",scope:"=scope"},transclude:!0,link:function(a,b,c,d,e){a.$parent.allSteps.push(a),a.$parent.step==a.number&&(a.$parent.step=a),e(a,function(a,c){angular.element(b[0].getElementsByClassName("sub-elements")[0]).append(a)})}}}),angular.module("nodegeeks-angular").directive("formWizard",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard.html",scope:{action:"=",title:"@",steps:"@"},transclude:!0,link:function(a,b,c,d,e){a.allSteps=[],a.step={number:1},a.percentage=1/a.steps*100,a.next=function(){a.step.number++,a.percentage=a.step.number/a.steps*100},a.back=function(){a.step.number--,a.percentage=a.step.number/a.steps*100},e(a,function(a,c){angular.element(b[0].getElementsByClassName("tab-content")[0]).append(a)})}}}),angular.module("nodegeeks-angular").factory("App",function(a){var b=a.Model();return b.define("app",{attributes:{name:{type:"string"},logo:{type:"string",defaultsTo:"/assets/images/logo.png"},description:{type:"string"},domain:{type:"string"},company:{type:"string"},version:{type:"float"},facebookAPI:{type:"string"},twitterAPI:{type:"string"},windowsAPI:{type:"string"},googleAPI:{type:"string"},facebookUrl:{type:"string"},twitterUrl:{type:"string"},windowsUrl:{type:"string"},googleUrl:{type:"string"}}}),b}),angular.module("nodegeeks-angular").factory("Conversation",function(a,b){var c=a.Model();return c.define("conversation",{attributes:{isUnread:{type:"boolean"},messages:{collection:"message"},participants:{collection:"profile"},lastMessage:function(){if(this.messages.length){var a=b("orderBy")(this.messages,"createdAt",!0)[0];return a.sender.firstName+" say's: "+a.content}}}}),c}),angular.module("nodegeeks-angular").factory("FileObj",function(a){var b=a.Model();return b.define("fileObj",{attributes:{path:{type:"string"},mime:{type:"string"},size:{type:"integer"}}}),b}),angular.module("nodegeeks-angular").factory("Issue",function(a){var b=a.Model();return b.define("issue",{attributes:{profile:{model:"Profile"},description:{type:"string"},status:{type:"string","enum":["closed","open","resolved"]},messages:{collection:"Message"}}}),b}),angular.module("nodegeeks-angular").factory("Message",function(a){var b=a.Model();return b.define("message",{attributes:{sender:{model:"profile"},content:{type:"string"},attachments:{collection:"fileObj"},conversation:{model:"conversation"},createdAt:{type:"string"},timeAgo:function(){return"11 seconds ago"},shortContent:function(){return this.content.length>49?this.content:this.content.substring(0,50)+"..."}}}),b}),angular.module("nodegeeks-angular").factory("Notification",function(a){var b=a.Model();return b.define("notification",{attributes:{subject:{type:"string"},type:{type:"string"},typeId:{type:"string"},timeAgo:function(){return"Earlier"},routePath:function(){switch(this.type){case"message":return"/dashboard/inbox/"+this.typeId;case"friend-request":return"/profile/"+this.typeId;case"comment-approval":return"/dashboard/article/"+this.typeId;default:return"/dashboard/inbox/notifications"}},content:{type:"string"},isUnread:{type:"boolean",defaultsTo:!0},profile:{model:"Profile"}}}),b}),angular.module("nodegeeks-angular").factory("Profile",function(a){var b=a.Model();return b.define("profile",{attributes:{firstName:{type:"string",required:!0},lastName:{type:"string",required:!0},name:function(){return this.firstName+" "+this.lastName},username:{type:"string"},email:{type:"email"},password:{type:"string"},token:{type:"string"},role:{type:"string","enum":["admin","moderator","billing","developer","member"],defaultsTo:"member"},image:{type:"string"},dob:{type:"date"},isActivated:{type:"boolean",defaultsTo:!1},notifications:{collection:"notification"},unreadNotifications:function(){return this.notifications.filter(function(a){return a.isUnread})},unreadConversations:function(){return this.conversations.filter(function(a){return a.isUnread})},conversations:{collection:"conversation"},socialProfiles:{collection:"social"},issues:{collection:"issue"}}}),b}),angular.module("nodegeeks-angular").factory("Social",function(a){var b=a.Model();return b.define("social",{attributes:{network:{type:"string"},profile:{model:"Profile"}}}),b}),angular.module("nodegeeks-angular").service("Auth",function(a,b,c,d,e,f,g){function h(){this.session=void 0,hello.on("auth.login",function(a){hello(a.network).api("/me").then(function(a){})})}return b.loginRedirect="/dashboard",b.logoutRedirect="/",h.prototype.login=function(h,i){var j=this;return f(function(f,k){d.request({method:"post",url:"/login",data:{login:h,password:i}},function(d){return 403==d.code||404==d.code?c.alert(d.message):d.isActivated?(e.setItem("session",d),j.session=b.session=a.Record(d),g.url(b.loginRedirect),void f(j.session)):c.alert("You need to activate your account before logging in.")},function(a){k(a)})})},h.prototype.logout=function(){var a=this;return f(function(d,f){a.session.token="",a.session.save().then(function(){a.session=b.session=void 0,e.removeItem("session"),g.url(b.logoutRedirect),d()},function(a){f(),c.alert(a.message)})})},h.prototype.validate=function(e){var f=this;d.request({method:"post",url:"/validate",data:{id:e.id,token:e.token}},function(c){f.session=b.session=a.Record(c),b.$apply()},function(a){c.alert(a.message)})},h.prototype.verify=function(a){this.login(this.session.email||this.session.username,a)},h.prototype.reset=function(e,f,g){d.request({method:"post",url:"/resetPassword",data:{id:e,hash:f,password:g}},function(c){_auth.session=b.session=a.Record(c),b.$apply()},function(a){c.alert(a.message)})},h.prototype.recover=function(a){d.request({method:"get",url:"/recoverPassword",data:{email:a}},function(a){alert(a.code)},function(a){c.alert(a.message)})},h.prototype.reset=function(a,b,e){return f(function(f,g){d.request({method:"post",url:"/resetPassword",data:{id:a,password:b,hash:e}},function(a){alert(a.code),f()},function(a){g(),c.alert(a.message)})})},h.prototype.signup=function(b){return f(function(d,e){a.create(b).then(function(b){c.alert("Activation email has been sent, check your email and active your account before logging in."),d(a.Record(b))},function(a){e(),c.alert(a.message)})})},h.prototype.social=function(a){hello(a).login()},new h}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},angular.module("nodegeeks-angular").service("DS",function(a,b,c,d){function e(){this.database={},this._models=[]}return e.prototype.Model=function(){function a(){this.modelName=void 0,this.attributes={},this._watch=!1}var e=this;return a.prototype.Record=function(a){function f(){var f=this;Object.defineProperty(this,"_model",{writable:!1,value:g,enumerable:!1,configurable:!1}),Object.defineProperty(this,"isDirty",{writable:!0,value:!1,enumerable:!1,configurable:!0});for(var h in g.attributes)if("function"==typeof g.attributes[h])Object.defineProperty(this,h,{get:g.attributes[h],enumerable:!1,configurable:!1});else if(g.attributes[h]&&g.attributes[h].model){var i=null;if(e._models.forEach(function(a){a.modelName==g.attributes[h].model&&(i=a)}),!i){var j=d.has(g.attributes[h].model.capitalize());if(!j)return console.error({message:"The `"+g.attributes[h].model+"` model service you are attempting to use does not exist.",code:"NO_MODEL_FOUND"});i=d.get(g.attributes[h].model.capitalize())}var k=function(){var b=this;return Object.defineProperty(this,"_model",{writable:!1,value:i,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_property",{writable:!1,value:h,enumerable:!1,configurable:!1}),a[this._property]&&a[this._property].constructor==Object?angular.extend(b,b._model.Record(a[this._property])):void(a[this._property]&&(b.id=a[this._property],b.get().then(function(a){return angular.extend(b,a)})))};k.prototype=Object.create(Object.prototype),k.prototype.get=function(){var a=this;return b(function(b,c){return a._model.findOne(a.id).then(function(c){b(a._model.Record(c))})})},Object.defineProperty(this,h,{writable:!0,value:new k,enumerable:!0,configurable:!0})}else if(g.attributes[h]&&g.attributes[h].collection){var i=null;if(e._models.forEach(function(a){a.modelName==g.attributes[h].collection&&(i=a)}),!i){var j=d.has(g.attributes[h].collection.capitalize());if(!j)return console.error({message:"The `"+g.attributes[h].collection+"` model service you are attempting to use does not exist.",code:"NO_MODEL_FOUND"});i=d.get(g.attributes[h].collection.capitalize())}var l=function(){var b=this;Object.defineProperty(this,"_model",{writable:!1,value:i,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_property",{writable:!1,value:h,enumerable:!1,configurable:!1}),a[this._property]&&a[this._property].length&&a[this._property].forEach(function(a){return a.constructor==Object?b.push(b._model.Record(a)):g.findOne(a).then(function(a){b.push(b._model.Record(a))})})};l.prototype=Object.create(Array.prototype),l.prototype.remove=function(a){var d=this;return b(function(b,e){if(a.constructor==Array)return console.error({message:"You passed an `array`, only objects, strings and integer datatypes allowed.",code:"INVALID_DATATYPE"});if(a.constructor==Object){if(!a.id)return e({error:"No `id` was found for the relationship record you passed",code:"MISSING_ID"});c.request({method:"delete",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){return c.error?e(c):(d.forEach(function(b){if(b.id==a.id){var c=d.indexOf(a);d.splice(c,1)}}),b(d._model.Record(c)))},function(a){return console.error(a),e(a)})}else c.request({method:"delete",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a},function(c){return c.error?e(c):(d.forEach(function(b){if(b.id==a){var c=d.indexOf(a);d.splice(c,1)}}),b(d._model.Record(c)))},function(a){return console.error(a),e(a)})})},l.prototype.add=function(a){var d=this;return b(function(b,e){return a.constructor==Array?console.error({message:"You passed an `array`, only objects, strings and integer datatypes allowed.",code:"INVALID_DATATYPE"}):void(a.constructor==Object?a.id?c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){if(c.error)return e(c);var f=c[d._property].indexOf(a),g=d._model.Record(c[d._property][f]);return d.push(g),b(g)},function(a){return console.error(a),e(a)}):d._model.create(a).then(function(a){c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){if(c.error)return e(c);var f=null;return c[d._property].forEach(function(b){b.id==a.id&&(f=d._model.Record(b))}),d.push(f),b(f)},function(a){return console.error(a),e(a)})},function(a){console.error(a)}):c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a},function(c){if(c.error)return e(c);var f=c[d._property].indexOf(a),g=d._model.Record(c[d._property][f]);return d.push(g),b(g)},function(a){return console.error(a),e(a)}))})},l.prototype.get=function(){var a=this;return b(function(b,c){a.forEach(function(c,d){return c.retrieve().then(function(b){a[d]=b},function(){}),d==a.length-1?b(a):void 0})})},Object.defineProperty(this,h,{writable:!0,value:new l,enumerable:!0,configurable:!0})}else Object.defineProperty(this,h,{writable:!0,value:a[h],enumerable:!0,configurable:!0})}var g=this;if(e.database[g.modelName][a.id])return e.database[g.modelName][a.id];f.prototype.destroy=function(){var a=this;return b(function(b,c){a._model["delete"](a.id).then(function(a){return e.database[g.modelName].removeItem(a.id),b(a)},function(a){return console.error(a),c(a)})})},f.prototype.retrieve=function(){var c=this;return b(function(b,d){c._model.findOne(c.id).then(function(c){return e.database[g.modelName][a.id]=c,b(c)},function(a){return console.error(a),d(a)})})},f.prototype.save=function(a,c){var d=this,e={};for(var f in this)this.hasOwnProperty(f)&&"function"!=typeof this[f]&&"__proto__"!==f&&"isDirty"!==f&&"updatedAt"!==f&&"_model"!==f&&"_data"!==f&&"id"!==f&&(e[f]=this[f]);return b(function(a,b){g.update(d.id,e).then(function(b){return a(b)})})};var h=new f;return h},a.prototype.define=function(a,b){var d=this;this.modelName=a,angular.extend(this,b),this.attributes.id=null,e.database[a]={},c.on(a,function(a){d.modelName;console.log(a)}),e._models.push(this)},a.prototype.create=function(a){var d=this;return b(function(b,f){for(var g in d.attributes)if(d.attributes.hasOwnProperty(g)&&!a[g]&&(d.attributes[g]&&d.attributes[g].defaultsTo&&(a[g]=d.attributes[g].defaultsTo),d.attributes[g]&&d.attributes[g].required))return f({message:"`"+g+"` is a required attribute"});for(var h in a)if(a.hasOwnProperty(h))if(!d.attributes[h]||d.attributes[h].collection||d.attributes[h].model)d.attributes[h]&&d.attributes[h].collection&&a[h].length,d.attributes[h]&&d.attributes[h].model&&("string"==typeof a[h]||"number"==typeof a[h]);else if("email"==d.attributes[h].type){var i=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);if(!i.test(a[h]))return f({message:"`"+h+"` needs to be a valid email"})}else if(typeof a[h]!==d.attributes[h].type)return f({message:"the value of "+h+" must be a "+d.attributes[h].type+" datatype"});c.request({method:"post",url:"/"+d.modelName,data:a},function(a){if(a.error){var c={};if("E_VALIDATION"==a.error)for(var g in a.invalidAttributes)if(a.invalidAttributes.hasOwnProperty(g))return c.message=a.invalidAttributes[g][0].message,c.code="UNIQUE",console.error(c),f(c);return f(a)}if(a.id){var h=d.Record(a);return e.database[d.modelName][a.id]=h,b(h)}},function(a){return console.error(a),f(a)})})},a.prototype.findOne=function(a){var d=this;return b(function(b,f){if(!a){var g={message:"Must pass the `id` parameter to the `findOne` method",code:"MISSING_PARAM"};return console.error(g),f(g)}c.request({method:"get",url:"/"+d.modelName+"/"+a},function(a){if("string"==typeof a)return f({message:a});var c=d.Record(a);return e.database[d.modelName][a.id]=c,a?b(c):void 0},function(a){return console.error(a),f(a)})})},a.prototype.findAll=function(a){var d=this,f="";return b(function(b,g){if(a){if("number"!=typeof a)return g({message:"must pass an integer",code:"INVALID_PARAM_PASSED"});f="?limit="+a}c.request({method:"get",url:"/"+d.modelName+f},function(a){if(a.length){var c=[];return a.forEach(function(a){var b=d.Record(a);e.database[d.modelName][a.id]=b,c.push(b)}),b(c)}return g({message:"No records found for `"+d.modelName+"`",code:"NO_RECORDS"})})})},a.prototype.query=function(a){var d=this,f="",g=!1;for(var h in a)a.hasOwnProperty(h)&&(g?f=f+"&"+h+"="+a[h]:(f=f+h+"="+a[h],g=!0));return b(function(a,b){c.request({method:"get",url:"/"+d.modelName+"?"+f},function(c){if(c.length){var f=[];return c.forEach(function(a){var b=d.Record(a);e.database[d.modelName][a.id]=b,f.push(b)}),a(f)}return b({message:"No records found for `"+d.modelName+"`",code:"NO_RECORDS"})})})},a.prototype["delete"]=function(a){var d=this;return b(function(b,f){c.request({method:"delete",url:"/"+d.modelName+"/"+a},function(a){return delete e.database[d.modelName][a.id],a?b(a):void 0},function(a){return console.error(a),f(a)})})},a.prototype.update=function(a,d){var f=this;return b(function(b,g){c.request({method:"put",data:d,url:"/"+f.modelName+"/"+a},function(a){var c=f.Record(a);return e.database[f.modelName][a.id]=c,a?b(c):void 0},function(a){return console.error(a),g(a)})})},new a},new e}),angular.module("nodegeeks-angular").service("LocalStorage",function(){return{getItem:function(a){var b=localStorage.getItem(a),c=JSON.parse(b);return c?c:b},setItem:function(a,b){return b.constructor==Object||b.constructor==Array?localStorage.setItem(a,JSON.stringify(b)):b.constructor==Function?console.error("Cannot set a function as a value"):localStorage.setItem(a,b)},removeItem:function(a){return localStorage.removeItem(a)}}}),angular.module("nodegeeks-angular").service("Notify",function(a,b){function c(){}return c.prototype.alert=function(a,b){alert(a)},new c}),angular.module("nodegeeks-angular").factory("settings",function(a){var b={layout:{pageSidebarClosed:!1,pageContentWhite:!0,pageBodySolid:!1,pageAutoScrollOnLoad:1e3},assetsPath:"assets",globalPath:"assets/global",layoutPath:"assets/layouts/layout4"};return a.settings=b,b}),function(){function a(a){function c(b){return b=b||{prefix:!0},"object"!=typeof console||"function"!=typeof console.log||"function"!=typeof console.log.bind?function(){}:function(){var c=Array.prototype.slice.call(arguments);if("production"!==a.sails.environment){var d="";b.prefix&&c.unshift(d),console.log.bind(console).apply(this,c)}}}function f(a){var b=a.requestQueue;if(b){for(var c in b){var d={}.hasOwnProperty.call(b,c);d&&i(a,b[c])}b=null}}function g(a,b){if(a=a||{},"undefined"==typeof window)return b();var c=document.createElement("script");window._sailsIoJSConnect=function(a){c.parentNode.removeChild(c),b(a)},c.src=a.url,document.getElementsByTagName("head")[0].appendChild(c)}function h(a){this.body=a.body||{},this.headers=a.headers||{},this.statusCode=a.statusCode||200,(this.statusCode<200||this.statusCode>=400)&&(this.error=this.body||this.statusCode)}function i(a,b){if(!a._raw)throw new Error("Failed to emit from socket- raw SIO socket is missing.");var c=b.cb;delete b.cb;var d=b.method;a._raw.emit(d,b,function(a){c&&c(a.body,new h(a))})}function j(a){var b=this;a=a||{},b.useCORSRouteToGetCookie=a.useCORSRouteToGetCookie,b.url=a.url,b.multiplex=a.multiplex,b.transports=a.transports,b.eventQueue={},b.on("sails:parseError",function(a){k("Sails encountered an error parsing a socket message sent from this client, and did not have access to a callback function to respond with."),k("Error details:",a)})}if(a||(a=e),!a)throw new Error("`sails.io.js` requires a socket.io client, but `io` was not passed in.");var k=c();return k.noPrefix=c({prefix:!1}),h.prototype.toString=function(){return"[ResponseFromSails]  -- Status: "+this.statusCode+"  -- Headers: "+this.headers+"  -- Body: "+this.body},h.prototype.toPOJO=function(){return{body:this.body,headers:this.headers,statusCode:this.statusCode}},h.prototype.pipe=function(){return new Error("Client-side streaming support not implemented yet.")},j.prototype._connect=function(){var b=this;b.useCORSRouteToGetCookie=b.useCORSRouteToGetCookie||a.sails.useCORSRouteToGetCookie,b.url=b.url||a.sails.url,b.transports=b.transports||a.sails.transports,b.url=b.url?b.url.replace(/(\/)$/,""):void 0,"string"!=typeof b.query?b.query=d.versionString:b.query+="&"+d.versionString;var c=function(){if("undefined"==typeof window||"undefined"==typeof window.location)return!1;if("string"!=typeof b.url)return!1;var a=function(){try{a=b.url.match(/^([a-z]+:\/\/)/i)[1].toLowerCase()}catch(c){}return a=a||"http://"}(),c=!!b.url.match("^https"),d=function(){try{return b.url.match(/^[a-z]+:\/\/[^:]*:([0-9]*)/i)[1]}catch(a){}return c?"443":"80"}(),e=b.url.replace(/^([a-z]+:\/\/)/i,"");if(a.replace(/[:\/]/g,"")!==window.location.protocol.replace(/[:\/]/g,""))return!0;var f=0===e.search(window.location.hostname);if(!f)return!0;var g=window.location.protocol.match(/https/i),h=window.location.port+""||(g?"443":"80");return d!==h?!0:!1}();!function(a){if(!b.useCORSRouteToGetCookie||!c)return a();var d=b.url;if(d+="string"==typeof b.useCORSRouteToGetCookie?b.useCORSRouteToGetCookie:"/__getcookie","undefined"!=typeof window)return void g({url:d,method:"GET"},a);var e=require("request");e.get(d,function(b,c,d){return b?void k("Failed to connect socket (failed to get cookie)","Error:",b):void a()})}(function(){b._raw=a(b.url,b),b.replay(),b.on("connect",function(){k.noPrefix("\n\n  |>    Now connected to Sails.\n\\___/   For help, see: http://bit.ly/1DmTvgK\n        (using "+a.sails.sdk.platform+" SDK @v"+a.sails.sdk.version+")\n\n\n")}),b.on("disconnect",function(){b.connectionLostTimestamp=(new Date).getTime(),k("===================================="),k("Socket was disconnected from Sails."),k("Usually, this is due to one of the following reasons:\n -> the server "+(b.url?b.url+" ":"")+"was taken down\n -> your browser lost internet connectivity"),k("====================================")}),b.on("reconnecting",function(a){k("\n        Socket is trying to reconnect to Sails...\n_-|>_-  (attempt #"+a+")\n\n")}),b.on("reconnect",function(a,c){var d=(new Date).getTime()-b.connectionLostTimestamp,e=d/1e3;k("\n  |>    Socket reconnected successfully after\n\\___/   being offline for ~"+e+" seconds.\n\n")}),b.on("error",function(a){k("Failed to connect socket (probably due to failed authorization on server)","Error:",a)})})},j.prototype.disconnect=function(){if(!this._raw)throw new Error("Cannot disconnect- socket is already disconnected");return this._raw.disconnect()},j.prototype.isConnected=function(){return this._raw?!!this._raw.connected:!1},j.prototype.replay=function(){var a=this;for(var b in a.eventQueue)for(var c in a.eventQueue[b])a._raw.on(b,a.eventQueue[b][c]);if(a.isConnected())f(a);else{var d=!1;a._raw.on("connect",function(){d||(f(a),d=!0)})}return a},j.prototype.on=function(a,b){return this._raw?(this._raw.on(a,b),this):(this.eventQueue[a]?this.eventQueue[a].push(b):this.eventQueue[a]=[b],this)},j.prototype.off=function(a,b){return this._raw?(this._raw.off(a,b),this):(this.eventQueue[a]&&this.eventQueue[a].indexOf(b)>-1&&this.eventQueue[a].splice(this.eventQueue[a].indexOf(b),1),this)},j.prototype.removeAllListeners=function(){return this._raw?(this._raw.removeAllListeners(),this):(this.eventQueue={},this)},j.prototype.get=function(a,b,c){return"function"==typeof b&&(c=b,b={}),this.request({method:"get",params:b,url:a},c)},j.prototype.post=function(a,b,c){return"function"==typeof b&&(c=b,b={}),this.request({method:"post",data:b,url:a},c)},j.prototype.put=function(a,b,c){return"function"==typeof b&&(c=b,b={}),this.request({method:"put",params:b,url:a},c)},j.prototype["delete"]=function(a,b,c){return"function"==typeof b&&(c=b,b={}),this.request({method:"delete",params:b,url:a},c)},j.prototype.request=function(a,b){var c='Usage:\nsocket.request( options, [fnToCallWhenComplete] )\n\noptions.url :: e.g. "/foo/bar"\noptions.method :: e.g. "get", "post", "put", or "delete", etc.\noptions.params :: e.g. { emailAddress: "mike@sailsjs.org" }\noptions.headers :: e.g. { "x-my-custom-header": "some string" }';if("object"!=typeof a||"string"!=typeof a.url)throw new Error("Invalid or missing URL!\n"+c);if(a.method&&"string"!=typeof a.method)throw new Error('Invalid `method` provided (should be a string like "post" or "put")\n'+c);if(a.headers&&"object"!=typeof a.headers)throw new Error("Invalid `headers` provided (should be an object with string values)\n"+c);if(a.params&&"object"!=typeof a.params)throw new Error("Invalid `params` provided (should be an object with string values)\n"+c);if(b&&"function"!=typeof b)throw new Error("Invalid callback function!\n"+c);var d={method:a.method.toLowerCase()||"get",headers:a.headers||{},data:a.params||a.data||{},url:a.url.replace(/^(.+)\/*\s*$/,"$1"),cb:b};return this.isConnected()?void i(this,d):(this.requestQueue=this.requestQueue||[],void this.requestQueue.push(d))},j.prototype._request=function(a,b){throw new Error("`_request()` was a private API deprecated as of v0.11 of the sails.io.js client. Use `.request()` instead.")},a.sails={autoConnect:!0,useCORSRouteToGetCookie:!0,environment:b.match(/(\#production|\.min\.js)/g)?"production":"development",sdk:d,transports:["polling","websocket"]},a.sails.connect=function(a,b){b=b||{},b.url=a||b.url||void 0;var c=new j(b);return c._connect(),c},a.socket=new j,setTimeout(function(){return a.sails.autoConnect?void a.socket._connect():void delete a.socket},0),a}var b=function(){if("object"!=typeof window||"object"!=typeof window.document||"function"!=typeof window.document.getElementsByTagName)return"";var a=window.document.getElementsByTagName("script"),b=a[a.length-1];return b.src}(),c={version:"__sails_io_sdk_version",platform:"__sails_io_sdk_platform",language:"__sails_io_sdk_language"},d={version:"0.11.0",platform:"undefined"==typeof module?"browser":"node",language:"javascript"};d.versionString=c.version+"="+d.version+"&"+c.platform+"="+d.platform+"&"+c.language+"="+d.language;var e="undefined"!=typeof io?io:null;return"object"==typeof module&&"undefined"!=typeof module.exports?(module.exports=a,a):"function"==typeof define&&define.amd?void define([],function(){return a}):a()}(),function(a,b){a.module("ngSails",["ng"]),function(a,b){function c(b){var c,e,f,g={};return b?(a.forEach(b.split("\n"),function(a){f=a.indexOf(":"),c=lowercase(d(a.substr(0,f))),e=d(a.substr(f+1)),c&&(g[c]=g[c]?g[c]+", "+e:e)}),g):g}function d(b){return a.isString(b)?b.trim():b}function e(b){return b&&a.isFunction(b.then)}function f(b){var d=a.isObject(b)?b:void 0;return function(a){if(d||(d=c(b)),a){var e=d[lowercase(a)];return void 0===e&&(e=null),e}return d}}b.sails&&(b.sails.autoConnect=!1),a.module("ngSails").provider("$sails",function(){var c=this;this.httpVerbs=["get","post","put","delete"],this.eventNames=["on","off"],this.url=void 0,this.urlPrefix="",this.config={transports:["websocket","polling"],useCORSRouteToGetCookie:!1},this.debug=!1;var d=this.interceptors=[];this.$get=["$q","$injector","$rootScope","$log","$timeout",function(g,h,i,j,k){function l(a){function b(){d(null)}function d(b,d){d||(d={body:b,headers:b.headers||{},statusCode:b.statusCode||b.status||0,error:function(){return this.statusCode<200||this.statusCode>=400?this.body||this.statusCode:void 0}()}),d.data=d.body,d.status=d.statusCode,d.socket=o,d.url=a.url,d.method=a.method,d.config=a.config,d.error?(c.debug&&j.warn("$sails response "+d.statusCode+" "+a.url,d),f.reject(d)):(c.debug&&j.info("$sails response "+a.url,d),f.resolve(d))}var f=g.defer();return c.debug&&j.info("$sails "+a.method+" "+a.url,a.data||""),a.timeout>0?k(b,a.timeout):e(a.timeout)&&a.timeout.then(b),o["legacy_"+a.method.toLowerCase()](a.url,a.data,d),f.promise}function m(b){o["legacy_"+b]=o[b],o[b]=function(d,e,h){var i=[l,void 0],j=g.when({url:c.urlPrefix+d,data:e,socket:o,config:h||{},method:b.toUpperCase()});for(a.forEach(p,function(a){(a.request||a.requestError)&&i.unshift(a.request,a.requestError),(a.response||a.responseError)&&i.push(a.response,a.responseError)});i.length;){var k=i.shift(),m=i.shift();j=j.then(k,m)}return j.success=function(a){return j.then(function(b){a(b.body,b.statusCode,f(b.headers),b)}),j},j.error=function(a){return j.then(null,function(b){a(b.body,b.statusCode,f(b.headers),b)}),j},j}}function n(b){(o[b]||o._raw&&o._raw[b])&&(o["legacy_"+b]=o[b]||o._raw[b],o[b]=function(c,d){var e=null;return"off"==b?o["legacy_"+b](c,d):(null!==d&&a.isFunction(d)&&o["legacy_"+b](c,e=function(a){i.$evalAsync(d.bind(o,a))}),e)})}var o=(b.sails&&b.sails.connect||b.connect)(c.url,c.config);o.connect=function(b){if(!o.isConnected()){var d=b||{};d=a.extend({},c.config,b),o.useCORSRouteToGetCookie=d.useCORSRouteToGetCookie,o.url=d.url||c.url,o.multiplex=d.multiplex,o._connect()}return o};var p=[];return a.forEach(d,function(b){p.unshift(a.isString(b)?h.get(b):h.invoke(b))}),o.once=function(b,c){null!==c&&a.isFunction(c)&&o._raw&&o._raw.once(b,function(a){i.$evalAsync(c.bind(o,a))})},a.forEach(c.httpVerbs,m),a.forEach(c.eventNames,n),o.$modelUpdater=function(b,c){var d=function(b){i.$evalAsync(function(){var d;switch(b.verb){case"created":c.push(b.data);break;case"updated":var e;for(d=0;d<c.length;d++)if(c[d].id===b.id){e=c[d];break}if(!e&&!b.previous)return;e||(e=b.previous,c.push(e)),a.extend(e,b.data);break;case"destroyed":for(d=0;d<c.length;d++)if(c[d].id===b.id){c.splice(d,1);break}}})};return o.legacy_on(b,d),function(){o.legacy_off(b,d)}},o}],this.$get.$inject=["$q","$injector","$rootScope","$log","$timeout"]})}(a,b)}(angular,io),Object.create||(Object.create=function(){function a(){}return function(b){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Object.keys||(Object.keys=function(a,b,c){c=[];for(b in a)c.hasOwnProperty.call(a,b)&&c.push(b);return c}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=arguments.length>=2?arguments[1]:void 0,e=0;c>e;e++)e in b&&a.call(d,b[e],e,b);return this}),Array.prototype.filter||(Array.prototype.filter=function(a,b){var c=[];return this.forEach(function(d,e,f){a.call(b||void 0,d,e,f)&&c.push(d)}),c}),Array.prototype.map||(Array.prototype.map=function(a,b){var c=[];return this.forEach(function(d,e,f){c.push(a.call(b||void 0,d,e,f))}),c}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(a){window.location=a}),Function.prototype.bind||(Function.prototype.bind=function(a){function b(){}if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=[].slice,d=c.call(arguments,1),e=this,f=function(){return e.apply(this instanceof b?this:a||window,d.concat(c.call(arguments)))};return b.prototype=this.prototype,f.prototype=new b,f});var hello=function(a){return hello.use(a)};hello.utils={extend:function(a){return Array.prototype.slice.call(arguments,1).forEach(function(b){if(a instanceof Object&&b instanceof Object&&a!==b)for(var c in b)a[c]=hello.utils.extend(a[c],b[c]);else a=b}),a}},hello.utils.extend(hello,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(a){var b=Object.create(this);return b.settings=Object.create(this.settings),a&&(b.settings.default_service=a),b.utils.Event.call(b),
b},init:function(a,b){var c=this.utils;if(!a)return this.services;for(var d in a)a.hasOwnProperty(d)&&"object"!=typeof a[d]&&(a[d]={id:a[d]});c.extend(this.services,a);for(d in this.services)this.services.hasOwnProperty(d)&&(this.services[d].scope=this.services[d].scope||{});return b&&(c.extend(this.settings,b),"redirect_uri"in b&&(this.settings.redirect_uri=c.url(b.redirect_uri).href)),this},login:function(){function a(a,b){hello.emit(a,b)}function b(a){return a}function c(a){return!!a}var d,e=this,f=e.utils,g=f.error,h=f.Promise(),i=f.args({network:"s",options:"o",callback:"f"},arguments),j=f.diffKey(i.options,e.settings),k=i.options=f.merge(e.settings,i.options||{});if(k.popup=f.merge(e.settings.popup,i.options.popup||{}),i.network=i.network||e.settings.default_service,h.proxy.then(i.callback,i.callback),h.proxy.then(a.bind(this,"auth.login auth"),a.bind(this,"auth.failed auth")),"string"!=typeof i.network||!(i.network in e.services))return h.reject(g("invalid_network","The provided network was not recognized"));var l=e.services[i.network],m=f.globalEvent(function(a){var b;b=a?JSON.parse(a):g("cancelled","The authentication was not completed"),b.error?h.reject(b):(f.store(b.network,b),h.fulfill({network:b.network,authResponse:b}))}),n=f.url(k.redirect_uri).href,o=l.oauth.response_type||k.response_type;/\bcode\b/.test(o)&&!l.oauth.grant&&(o=o.replace(/\bcode\b/,"token")),i.qs=f.merge(j,{client_id:encodeURIComponent(l.id),response_type:encodeURIComponent(o),redirect_uri:encodeURIComponent(n),display:k.display,scope:"basic",state:{client_id:l.id,network:i.network,display:k.display,callback:m,state:k.state,redirect_uri:n}});var p=f.store(i.network),q=/[,\s]+/,r=(k.scope||"").toString()+","+i.qs.scope;if(p&&"scope"in p&&p.scope instanceof String&&(r+=","+p.scope),r=r.split(q),r=f.unique(r).filter(c),i.qs.state.scope=r.join(","),r=r.map(function(a){if(a in l.scope)return l.scope[a];for(var b in e.services){var c=e.services[b].scope;if(c&&a in c)return""}return a}),r=r.join(",").split(q),r=f.unique(r).filter(c),i.qs.scope=r.join(l.scope_delim||","),k.force===!1&&p&&"access_token"in p&&p.access_token&&"expires"in p&&p.expires>(new Date).getTime()/1e3){var s=f.diff((p.scope||"").split(q),(i.qs.state.scope||"").split(q));if(0===s.length)return h.fulfill({unchanged:!0,network:i.network,authResponse:p}),h}if("page"===k.display&&k.page_uri&&(i.qs.state.page_uri=f.url(k.page_uri).href),"login"in l&&"function"==typeof l.login&&l.login(i),(!/\btoken\b/.test(o)||parseInt(l.oauth.version,10)<2||"none"===k.display&&l.oauth.grant&&p&&p.refresh_token)&&(i.qs.state.oauth=l.oauth,i.qs.state.oauth_proxy=k.oauth_proxy),i.qs.state=encodeURIComponent(JSON.stringify(i.qs.state)),1===parseInt(l.oauth.version,10)?d=f.qs(k.oauth_proxy,i.qs,b):"none"===k.display&&l.oauth.grant&&p&&p.refresh_token?(i.qs.refresh_token=p.refresh_token,d=f.qs(k.oauth_proxy,i.qs,b)):d=f.qs(l.oauth.auth,i.qs,b),"none"===k.display)f.iframe(d,n);else if("popup"===k.display)var t=f.popup(d,n,k.popup),u=setInterval(function(){if((!t||t.closed)&&(clearInterval(u),!h.state)){var a=g("cancelled","Login has been cancelled");t||(a=g("blocked","Popup was blocked")),a.network=i.network,h.reject(a)}},100);else window.location=d;return h.proxy},logout:function(){function a(a,b){hello.emit(a,b)}var b=this,c=b.utils,d=c.error,e=c.Promise(),f=c.args({name:"s",options:"o",callback:"f"},arguments);if(f.options=f.options||{},e.proxy.then(f.callback,f.callback),e.proxy.then(a.bind(this,"auth.logout auth"),a.bind(this,"error")),f.name=f.name||this.settings.default_service,f.authResponse=c.store(f.name),!f.name||f.name in b.services)if(f.name&&f.authResponse){var g=function(a){c.store(f.name,""),e.fulfill(hello.utils.merge({network:f.name},a||{}))},h={};if(f.options.force){var i=b.services[f.name].logout;if(i)if("function"==typeof i&&(i=i(g,f)),"string"==typeof i)c.iframe(i),h.force=null,h.message="Logout success on providers site was indeterminate";else if(void 0===i)return e.proxy}g(h)}else e.reject(d("invalid_session","There was no session to remove"));else e.reject(d("invalid_network","The network was unrecognized"));return e.proxy},getAuthResponse:function(a){return a=a||this.settings.default_service,a&&a in this.services?this.utils.store(a)||null:null},events:{}}),hello.utils.extend(hello.utils,{error:function(a,b){return{error:{code:a,message:b}}},qs:function(a,b,c){if(b){c=c||encodeURIComponent;for(var d in b){var e="([\\?\\&])"+d+"=[^\\&]*",f=new RegExp(e);a.match(f)&&(a=a.replace(f,"$1"+d+"="+c(b[d])),delete b[d])}}return this.isEmpty(b)?a:a+(a.indexOf("?")>-1?"&":"?")+this.param(b,c)},param:function(a,b){var c,d,e={};if("string"==typeof a){if(b=b||decodeURIComponent,d=a.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var f=0;f<d.length;f++)c=d[f].match(/([^=]+)=(.*)/),e[c[1]]=b(c[2]);return e}b=b||encodeURIComponent;var g=a;e=[];for(var h in g)g.hasOwnProperty(h)&&g.hasOwnProperty(h)&&e.push([h,"?"===g[h]?"?":b(g[h])].join("="));return e.join("&")},store:function(){function a(){var a={};try{a=JSON.parse(c.getItem("hello"))||{}}catch(b){}return a}function b(a){c.setItem("hello",JSON.stringify(a))}for(var c,d=["localStorage","sessionStorage"],e=-1,f="test";d[++e];)try{c=window[d[e]],c.setItem(f+e,e),c.removeItem(f+e);break}catch(g){c=null}if(!c){var h=null;c={getItem:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].replace(/(^\s+|\s+$)/,"");if(d&&0===d.indexOf(a))return d.substr(a.length)}return h},setItem:function(a,b){h=b,document.cookie=a+"="+b}},h=c.getItem("hello")}return function(c,d,e){var f=a();if(c&&void 0===d)return f[c]||null;if(c&&null===d)try{delete f[c]}catch(g){f[c]=null}else{if(!c)return f;f[c]=d}return b(f),f||null}}(),append:function(a,b,c){var d="string"==typeof a?document.createElement(a):a;if("object"==typeof b)if("tagName"in b)c=b;else for(var e in b)if(b.hasOwnProperty(e))if("object"==typeof b[e])for(var f in b[e])b[e].hasOwnProperty(f)&&(d[e][f]=b[e][f]);else"html"===e?d.innerHTML=b[e]:/^on/.test(e)?d[e]=b[e]:d.setAttribute(e,b[e]);return"body"===c?!function g(){document.body?document.body.appendChild(d):setTimeout(g,16)}():"object"==typeof c?c.appendChild(d):"string"==typeof c&&document.getElementsByTagName(c)[0].appendChild(d),d},iframe:function(a){this.append("iframe",{src:a,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var a=Array.prototype.slice.call(arguments);return a.unshift({}),this.extend.apply(null,a)},args:function(a,b){var c={},d=0,e=null,f=null;for(f in a)if(a.hasOwnProperty(f))break;if(1===b.length&&"object"==typeof b[0]&&"o!"!=a[f])for(f in b[0])if(a.hasOwnProperty(f)&&f in a)return b[0];for(f in a)if(a.hasOwnProperty(f))if(e=typeof b[d],"function"==typeof a[f]&&a[f].test(b[d])||"string"==typeof a[f]&&(a[f].indexOf("s")>-1&&"string"===e||a[f].indexOf("o")>-1&&"object"===e||a[f].indexOf("i")>-1&&"number"===e||a[f].indexOf("a")>-1&&"object"===e||a[f].indexOf("f")>-1&&"function"===e))c[f]=b[d++];else if("string"==typeof a[f]&&a[f].indexOf("!")>-1)return!1;return c},url:function(a){if(a){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(a,window.location);var b=document.createElement("a");return b.href=a,b.cloneNode(!1)}return window.location},diff:function(a,b){return b.filter(function(b){return-1===a.indexOf(b)})},diffKey:function(a,b){if(a||!b){var c={};for(var d in a)d in b||(c[d]=a[d]);return c}return a},unique:function(a){return Array.isArray(a)?a.filter(function(b,c){return a.indexOf(b)===c}):[]},isEmpty:function(a){if(!a)return!0;if(Array.isArray(a))return!a.length;if("object"==typeof a)for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},Promise:function(){var a=0,b=1,c=2,d=function(b){return this instanceof d?(this.id="Thenable/1.0.6",this.state=a,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof b&&b.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new d(b)};d.prototype={fulfill:function(a){return e(this,b,"fulfillValue",a)},reject:function(a){return e(this,c,"rejectReason",a)},then:function(a,b){var c=this,e=new d;return c.onFulfilled.push(h(a,e,"fulfill")),c.onRejected.push(h(b,e,"reject")),f(c),e.proxy}};var e=function(b,c,d,e){return b.state===a&&(b.state=c,b[d]=e,f(b)),b},f=function(a){a.state===b?g(a,"onFulfilled",a.fulfillValue):a.state===c&&g(a,"onRejected",a.rejectReason)},g=function(a,b,c){if(0!==a[b].length){var d=a[b];a[b]=[];var e=function(){for(var a=0;a<d.length;a++)d[a](c)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(e):"function"==typeof setImmediate?setImmediate(e):setTimeout(e,0)}},h=function(a,b,c){return function(d){if("function"!=typeof a)b[c].call(b,d);else{var e;try{e=a(d)}catch(f){return void b.reject(f)}i(b,e)}}},i=function(a,b){if(a===b||a.proxy===b)return void a.reject(new TypeError("cannot resolve promise with itself"));var c;if("object"==typeof b&&null!==b||"function"==typeof b)try{c=b.then}catch(d){return void a.reject(d)}if("function"!=typeof c)a.fulfill(b);else{var e=!1;try{c.call(b,function(c){e||(e=!0,c===b?a.reject(new TypeError("circular thenable chain")):i(a,c))},function(b){e||(e=!0,a.reject(b))})}catch(d){e||a.reject(d)}}};return d}(),Event:function(){var a=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(b,c){if(c&&"function"==typeof c)for(var d=b.split(a),e=0;e<d.length;e++)this.events[d[e]]=[c].concat(this.events[d[e]]||[]);return this},this.off=function(a,b){return this.findEvents(a,function(a,c){b&&this.events[a][c]!==b||(this.events[a][c]=null)}),this},this.emit=function(a){var b=Array.prototype.slice.call(arguments,1);b.push(a);for(var c=function(c,d){b[b.length-1]="*"===c?a:c,this.events[c][d].apply(this,b)},d=this;d&&d.findEvents;)d.findEvents(a+",*",c),d=d.parent;return this},this.emitAfter=function(){var a=this,b=arguments;return setTimeout(function(){a.emit.apply(a,b)},0),this},this.findEvents=function(b,c){var d=b.split(a);for(var e in this.events)if(this.events.hasOwnProperty(e)&&d.indexOf(e)>-1)for(var f=0;f<this.events[e].length;f++)this.events[e][f]&&c.call(this,e,f)},this},globalEvent:function(a,b){return b=b||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[b]=function(){try{a.apply(this,arguments)&&delete window[b]}catch(c){console.error(c)}},b},popup:function(a,b,c){var d=document.documentElement;if(c.height){var e=void 0!==window.screenTop?window.screenTop:screen.top,f=screen.height||window.innerHeight||d.clientHeight;c.top=parseInt((f-c.height)/2,10)+e}if(c.width){var g=void 0!==window.screenLeft?window.screenLeft:screen.left,h=screen.width||window.innerWidth||d.clientWidth;c.left=parseInt((h-c.width)/2,10)+g}var i=[];Object.keys(c).forEach(function(a){var b=c[a];i.push(a+(null!==b?"="+b:""))});var j=function(a){var c=window.open(a,"_blank",i.join(","));try{if(c&&c.addEventListener){var d=hello.utils.url(b),e=d.origin||d.protocol+"//"+d.hostname;c.addEventListener("loadstart",function(a){var b=a.url;if(0===b.indexOf(e)){var d=hello.utils.url(b),f={location:{assign:function(a){c.addEventListener("exit",function(){setTimeout(function(){j(a)},1e3)})},search:d.search,hash:d.hash,href:d.href},close:function(){c.close&&c.close()}};hello.utils.responseHandler(f,window),f.close()}})}}catch(f){}return c&&c.focus&&c.focus(),c};return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(a=b+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(a))),j(a)},responseHandler:function(a,b){function c(a,b,c){var e=a.callback,g=a.network;if(f.store(g,a),!("display"in a&&"page"===a.display)){if(c&&e&&e in c){try{delete a.callback}catch(h){}f.store(g,a);var i=JSON.stringify(a);try{c[e](i)}catch(h){}}d()}}function d(){try{a.close()}catch(b){}a.addEventListener&&a.addEventListener("load",function(){a.close()})}var e,f=this,g=a.location;if(e=f.param(g.search),e&&e.state&&(e.code||e.oauth_token)){var h=JSON.parse(e.state);e.redirect_uri=h.redirect_uri||g.href.replace(/[\?\#].*$/,"");var i=h.oauth_proxy+"?"+f.param(e);return void g.assign(i)}if(e=f.merge(f.param(g.search||""),f.param(g.hash||"")),e&&"state"in e){try{var j=JSON.parse(e.state);f.extend(e,j)}catch(k){console.error("Could not decode state parameter")}if("access_token"in e&&e.access_token&&e.network)e.expires_in&&0!==parseInt(e.expires_in,10)||(e.expires_in=0),e.expires_in=parseInt(e.expires_in,10),e.expires=(new Date).getTime()/1e3+(e.expires_in||31536e3),c(e,a,b);else if("error"in e&&e.error&&e.network)e.error={code:e.error,message:e.error_message||e.error_description},c(e,a,b);else if(e.callback&&e.callback in b){var l="result"in e&&e.result?JSON.parse(e.result):!1;b[e.callback](l),d()}e.page_uri&&g.assign(e.page_uri)}else if("oauth_redirect"in e)return void g.assign(decodeURIComponent(e.oauth_redirect))}}),hello.utils.Event.call(hello),hello.utils.responseHandler(window,window.opener||window.parent),function(a){var b={},c={};a.on("auth.login, auth.logout",function(c){c&&"object"==typeof c&&c.network&&(b[c.network]=a.utils.store(c.network)||{})}),function d(){var e=(new Date).getTime()/1e3,f=function(b){a.emit("auth."+b,{network:g,authResponse:h})};for(var g in a.services)if(a.services.hasOwnProperty(g)){if(!a.services[g].id)continue;var h=a.utils.store(g)||{},i=a.services[g],j=b[g]||{};if(h&&"callback"in h){var k=h.callback;try{delete h.callback}catch(l){}a.utils.store(g,h);try{window[k](h)}catch(l){}}if(h&&"expires"in h&&h.expires<e){var m=i.refresh||h.refresh_token;!m||g in c&&!(c[g]<e)?m||g in c||(f("expired"),c[g]=!0):(a.emit("notice",g+" has expired trying to resignin"),a.login(g,{display:"none",force:!1}),c[g]=e+600);continue}if(j.access_token===h.access_token&&j.expires===h.expires)continue;!h.access_token&&j.access_token?f("logout"):h.access_token&&!j.access_token?f("login"):h.expires!==j.expires&&f("update"),b[g]=h,g in c&&delete c[g]}setTimeout(d,1e3)}()}(hello),hello.api=function(){function a(a){a=a.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,function(a,b,c){var g=c?c.replace(/^\|/,""):"";return b in f.query?(g=f.query[b],delete f.query[b]):f.data&&b in f.data?(g=f.data[b],delete f.data[b]):c||e.reject(d("missing_attribute","The attribute "+b+" is missing from the request")),g}),a.match(/^https?:\/\//)||(a=j.base+a),f.url=a,c.request(f,function(a,b){if(!f.formatResponse)return void(("object"==typeof b?b.statusCode>=400:"object"==typeof a&&"error"in a)?e.reject(a):e.fulfill(a));if(a===!0?a={success:!0}:a||(a={}),"delete"===f.method&&(a=!a||c.isEmpty(a)?{success:!0}:a),j.wrap&&(f.path in j.wrap||"default"in j.wrap)){var d=f.path in j.wrap?f.path:"default",g=((new Date).getTime(),j.wrap[d](a,b,f));g&&(a=g)}a&&"paging"in a&&a.paging.next&&("?"===a.paging.next[0]?a.paging.next=f.path+a.paging.next:a.paging.next+="#"+f.path),!a||"error"in a?e.reject(a):e.fulfill(a)})}var b=this,c=b.utils,d=c.error,e=c.Promise(),f=c.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);f.method=(f.method||"get").toLowerCase(),f.headers=f.headers||{},f.query=f.query||{},("get"===f.method||"delete"===f.method)&&(c.extend(f.query,f.data),f.data={});var g=f.data=f.data||{};if(e.then(f.callback,f.callback),!f.path)return e.reject(d("invalid_path","Missing the path parameter from the request"));f.path=f.path.replace(/^\/+/,"");var h=(f.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(h in b.services){f.network=h;var i=new RegExp("^"+h+":?/?");f.path=f.path.replace(i,"")}f.network=b.settings.default_service=f.network||b.settings.default_service;var j=b.services[f.network];if(!j)return e.reject(d("invalid_network","Could not match the service requested: "+f.network));if(f.method in j&&f.path in j[f.method]&&j[f.method][f.path]===!1)return e.reject(d("invalid_path","The provided path is not available on the selected network"));f.oauth_proxy||(f.oauth_proxy=b.settings.oauth_proxy),"proxy"in f||(f.proxy=f.oauth_proxy&&j.oauth&&1===parseInt(j.oauth.version,10)),"timeout"in f||(f.timeout=b.settings.timeout),"formatResponse"in f||(f.formatResponse=!0),f.authResponse=b.getAuthResponse(f.network),f.authResponse&&f.authResponse.access_token&&(f.query.access_token=f.authResponse.access_token);var k,l=f.path;f.options=c.clone(f.query),f.data=c.clone(g);var m=j[{"delete":"del"}[f.method]||f.method]||{};if("get"===f.method){var n=l.split(/[\?#]/)[1];n&&(c.extend(f.query,c.param(n)),l=l.replace(/\?.*?(#|$)/,"$1"))}return(k=l.match(/#(.+)/,""))?(l=l.split("#")[0],f.path=k[1]):l in m?(f.path=l,l=m[l]):"default"in m&&(l=m["default"]),f.redirect_uri=b.settings.redirect_uri,f.xhr=j.xhr,f.jsonp=j.jsonp,f.form=j.form,"function"==typeof l?l(f,a):a(l),e.proxy},hello.utils.extend(hello.utils,{request:function(a,b){function c(a,b){var c;a.authResponse&&a.authResponse.oauth&&1===parseInt(a.authResponse.oauth.version,10)&&(c=a.query.access_token,delete a.query.access_token,a.proxy=!0),!a.data||"get"!==a.method&&"delete"!==a.method||(d.extend(a.query,a.data),a.data=null);var e=d.qs(a.url,a.query);a.proxy&&(e=d.qs(a.oauth_proxy,{path:e,access_token:c||"",then:a.proxy_response_type||("get"===a.method.toLowerCase()?"redirect":"proxy"),method:a.method.toLowerCase(),suppress_response_codes:!0})),b(e)}var d=this,e=d.error;d.isEmpty(a.data)||"FileList"in window||!d.hasBinary(a.data)||(a.xhr=!1,a.jsonp=!1);var f=this.request_cors(function(){return void 0===a.xhr||a.xhr&&("function"!=typeof a.xhr||a.xhr(a,a.query))});if(f)return void c(a,function(c){var e=d.xhr(a.method,c,a.headers,a.data,b);e.onprogress=a.onprogress||null,e.upload&&a.onuploadprogress&&(e.upload.onprogress=a.onuploadprogress)});var g=a.query;if(a.query=d.clone(a.query),a.callbackID=d.globalEvent(),a.jsonp!==!1){if(a.query.callback=a.callbackID,"function"==typeof a.jsonp&&a.jsonp(a,a.query),"get"===a.method)return void c(a,function(c){d.jsonp(c,b,a.callbackID,a.timeout)});a.query=g}if(a.form!==!1){a.query.redirect_uri=a.redirect_uri,a.query.state=JSON.stringify({callback:a.callbackID});var h;if("function"==typeof a.form&&(h=a.form(a,a.query)),"post"===a.method&&h!==!1)return void c(a,function(c){d.post(c,a.data,h,b,a.callbackID,a.timeout)})}b(e("invalid_request","There was no mechanism for handling this request"))},request_cors:function(a){return"withCredentials"in new XMLHttpRequest&&a()},domInstance:function(a,b){var c="HTML"+(a||"").replace(/^[a-z]/,function(a){return a.toUpperCase()})+"Element";return b?window[c]?b instanceof window[c]:window.Element?b instanceof window.Element&&(!a||b.tagName&&b.tagName.toLowerCase()===a):!(b instanceof Object||b instanceof Array||b instanceof String||b instanceof Number)&&b.tagName&&b.tagName.toLowerCase()===a:!1},clone:function(a){if(null===a||"object"!=typeof a||a instanceof Date||"nodeName"in a||this.isBinary(a))return a;if(Array.isArray(a))return a.map(this.clone.bind(this));var b={};for(var c in a)b[c]=this.clone(a[c]);return b},xhr:function(a,b,c,d,e){function f(a){for(var b,c={},d=/([a-z\-]+):\s?(.*);?/gi;b=d.exec(a);)c[b[1]]=b[2];return c}var g=new XMLHttpRequest,h=this.error,i=!1;"blob"===a&&(i=a,a="GET"),a=a.toUpperCase(),g.onload=function(b){var c=g.response;try{c=JSON.parse(g.responseText)}catch(d){401===g.status&&(c=h("access_denied",g.statusText))}var i=f(g.getAllResponseHeaders());i.statusCode=g.status,e(c||("GET"===a?h("empty_response","Could not get resource"):{}),i)},g.onerror=function(a){var b=g.responseText;try{b=JSON.parse(g.responseText)}catch(c){}e(b||h("access_denied","Could not get resource"))};var j;if("GET"===a||"DELETE"===a)d=null;else if(d&&"string"!=typeof d&&!(d instanceof FormData)&&!(d instanceof File)&&!(d instanceof Blob)){var k=new FormData;for(j in d)d.hasOwnProperty(j)&&(d[j]instanceof HTMLInputElement?"files"in d[j]&&d[j].files.length>0&&k.append(j,d[j].files[0]):d[j]instanceof Blob?k.append(j,d[j],d.name):k.append(j,d[j]));d=k}if(g.open(a,b,!0),i&&("responseType"in g?g.responseType=i:g.overrideMimeType("text/plain; charset=x-user-defined")),c)for(j in c)g.setRequestHeader(j,c[j]);return g.send(d),g},jsonp:function(a,b,c,d){var e,f=this,g=f.error,h=0,i=document.getElementsByTagName("head")[0],j=g("server_error","server_error"),k=function(){h++||window.setTimeout(function(){b(j),i.removeChild(l)},0)};c=f.globalEvent(function(a){return j=a,!0},c),a=a.replace(new RegExp("=\\?(&|$)"),"="+c+"$1");var l=f.append("script",{id:c,name:c,src:a,async:!0,onload:k,onerror:k,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&k()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(e=f.append("script",{text:"document.getElementById('"+c+"').onerror();"}),l.async=!1),d&&window.setTimeout(function(){j=g("timeout","timeout"),k()},d),i.appendChild(l),e&&i.appendChild(e)},post:function(a,b,c,d,e,f){var g,h=this,i=h.error,j=document,k=null,l=[],m=0,n=null,o=0,p=function(a){o++||d(a)};h.globalEvent(p,e);var q;try{q=j.createElement('<iframe name="'+e+'">')}catch(r){q=j.createElement("iframe")}if(q.name=e,q.id=e,q.style.display="none",c&&c.callbackonload&&(q.onload=function(){p({response:"posted",message:"Content was posted"})}),f&&setTimeout(function(){p(i("timeout","The post operation timed out"))},f),j.body.appendChild(q),h.domInstance("form",b)){for(k=b.form,m=0;m<k.elements.length;m++)k.elements[m]!==b&&k.elements[m].setAttribute("disabled",!0);b=k}if(h.domInstance("form",b))for(k=b,m=0;m<k.elements.length;m++)k.elements[m].disabled||"file"!==k.elements[m].type||(k.encoding=k.enctype="multipart/form-data",k.elements[m].setAttribute("name","file"));else{for(n in b)b.hasOwnProperty(n)&&h.domInstance("input",b[n])&&"file"===b[n].type&&(k=b[n].form,k.encoding=k.enctype="multipart/form-data");k||(k=j.createElement("form"),j.body.appendChild(k),g=k);var s;for(n in b)if(b.hasOwnProperty(n)){var t=h.domInstance("input",b[n])||h.domInstance("textArea",b[n])||h.domInstance("select",b[n]);if(t&&b[n].form===k)t&&b[n].name!==n&&(b[n].setAttribute("name",n),b[n].name=n);else{var u=k.elements[n];if(s)for(u instanceof NodeList||(u=[u]),m=0;m<u.length;m++)u[m].parentNode.removeChild(u[m]);s=j.createElement("input"),s.setAttribute("type","hidden"),s.setAttribute("name",n),t?s.value=b[n].value:h.domInstance(null,b[n])?s.value=b[n].innerHTML||b[n].innerText:s.value=b[n],k.appendChild(s)}}for(m=0;m<k.elements.length;m++)s=k.elements[m],s.name in b||s.getAttribute("disabled")===!0||(s.setAttribute("disabled",!0),l.push(s))}k.setAttribute("method","POST"),k.setAttribute("target",e),k.target=e,k.setAttribute("action",a),setTimeout(function(){k.submit(),setTimeout(function(){try{g&&g.parentNode.removeChild(g)}catch(a){try{console.error("HelloJS: could not remove iframe")}catch(b){}}for(var c=0;c<l.length;c++)l[c]&&(l[c].setAttribute("disabled",!1),l[c].disabled=!1)},0)},100)},hasBinary:function(a){for(var b in a)if(a.hasOwnProperty(b)&&this.isBinary(a[b]))return!0;return!1},isBinary:function(a){return a instanceof Object&&(this.domInstance("input",a)&&"file"===a.type||"FileList"in window&&a instanceof window.FileList||"File"in window&&a instanceof window.File||"Blob"in window&&a instanceof window.Blob)},toBlob:function(a){var b=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,c=a.match(b);if(!c)return a;for(var d=atob(a.replace(b,"")),e=[],f=0;f<d.length;f++)e.push(d.charCodeAt(f));return new Blob([new Uint8Array(e)],{type:c[1]})}}),function(a){var b=a.api,c=a.utils;c.extend(c,{dataToJSON:function(a){var b=this,c=window,d=a.data;if(b.domInstance("form",d)?d=b.nodeListToJSON(d.elements):"NodeList"in c&&d instanceof NodeList?d=b.nodeListToJSON(d):b.domInstance("input",d)&&(d=b.nodeListToJSON([d])),("File"in c&&d instanceof c.File||"Blob"in c&&d instanceof c.Blob||"FileList"in c&&d instanceof c.FileList)&&(d={file:d}),!("FormData"in c&&d instanceof c.FormData))for(var e in d)if(d.hasOwnProperty(e))if("FileList"in c&&d[e]instanceof c.FileList)1===d[e].length&&(d[e]=d[e][0]);else{if(b.domInstance("input",d[e])&&"file"===d[e].type)continue;b.domInstance("input",d[e])||b.domInstance("select",d[e])||b.domInstance("textArea",d[e])?d[e]=d[e].value:b.domInstance(null,d[e])&&(d[e]=d[e].innerHTML||d[e].innerText)}return a.data=d,d},nodeListToJSON:function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];!d.disabled&&d.name&&("file"===d.type?b[d.name]=d:b[d.name]=d.value||d.innerHTML)}return b}}),a.api=function(){var a=c.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return a.data&&c.dataToJSON(a),b.call(this,a)}}(hello),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&!function(){function a(b,c){var d={closed:!1};return chrome.identity.launchWebAuthFlow({url:b,interactive:c},function(b){if(void 0===b)return void(d.closed=!0);var c=hello.utils.url(b),e={location:{assign:function(b){a(b,!1)},search:c.search,hash:c.hash,href:c.href},close:function(){}};hello.utils.responseHandler(e,window)}),d}hello.utils.popup=function(b){return a(b,!0)},hello.utils.iframe=function(b){a(b,!1)},hello.utils.request_cors=function(a){return a(),!0};var b={};chrome.storage.local.get("hello",function(a){b=a.hello||{}}),hello.utils.store=function(a,c){return 0===arguments.length?b:1===arguments.length?b[a]||null:c?(b[a]=c,chrome.storage.local.set({hello:b}),c):null===c?(delete b[a],chrome.storage.local.set({hello:b}),null):void 0}}(),function(){/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova&&(hello.utils.iframe=function(a,b){hello.utils.popup(a,b,{hidden:"yes"})})}(),"function"==typeof define&&define.amd&&define(function(){return hello}),"object"==typeof module&&module.exports&&(module.exports=hello);