/*! nodegeeks-angular 01-01-2016 */
"use strict";angular.module("nodegeeks-angular",["ngSails","door3.css"]).config(function(a){a.url="http://localhost:1337",a.debug=!0}),angular.module("nodegeeks-angular").controller("NodeGeeksController",function(){}),angular.module("nodegeeks-angular").factory("NodeGeeksModel",function(a){var b=a.Model();return b.define("nodegeeksmodel",{attributes:{}}),b}),angular.module("nodegeeks-angular").controller("AuthCtrl",function(a,b){a.login=b.login,a.signup=b.signup,a.social=b.social,a.recover=b.recover,a.logout=b.logout,a.validate=b.validate}),angular.module("nodegeeks-angular").controller("CountdownCtrl",function(a,b,c,d){}),angular.module("nodegeeks-angular").controller("SetupCtrl",function(a,b,c,d){a.app&&d.path("/"),b.setupApp=function(b){c.create(b).then(function(b){a.app=b,d.path("/")},function(a){alert(a.message)})}}),angular.module("nodegeeks-angular").directive("formWizardStepInput",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard-step-input.html",scope:{property:"=",label:"@",placeholder:"@",type:"@",col:"@"}}}),angular.module("nodegeeks-angular").directive("formWizardStep",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard-step.html",scope:{title:"@",number:"@",scope:"=scope"},transclude:!0,link:function(a,b,c,d,e){a.$parent.allSteps.push(a),a.$parent.step==a.number&&(a.$parent.step=a),e(a,function(a,c){angular.element(b[0].getElementsByClassName("sub-elements")[0]).append(a)})}}}),angular.module("nodegeeks-angular").directive("formWizard",function(){return{restrict:"E",templateUrl:"views/nodegeeks/directives/form-wizard.html",scope:{action:"=",title:"@",steps:"@"},transclude:!0,link:function(a,b,c,d,e){a.allSteps=[],a.step={number:1},a.percentage=1/a.steps*100,a.next=function(){a.step.number++,a.percentage=a.step.number/a.steps*100},a.back=function(){a.step.number--,a.percentage=a.step.number/a.steps*100},e(a,function(a,c){angular.element(b[0].getElementsByClassName("tab-content")[0]).append(a)})}}}),angular.module("nodegeeks-angular").factory("App",function(a){var b=a.Model();return b.define("app",{attributes:{name:{type:"string"},logo:{type:"string",defaultsTo:"/assets/images/logo.png"},description:{type:"string"},domain:{type:"string"},company:{type:"string"},version:{type:"float"},facebookAPI:{type:"string"},twitterAPI:{type:"string"},windowsAPI:{type:"string"},googleAPI:{type:"string"},facebookUrl:{type:"string"},twitterUrl:{type:"string"},windowsUrl:{type:"string"},googleUrl:{type:"string"}}}),b}),angular.module("nodegeeks-angular").factory("Conversation",function(a,b){var c=a.Model();return c.define("conversation",{attributes:{isUnread:{type:"boolean"},messages:{collection:"message"},participants:{collection:"profile"},lastMessage:function(){if(this.messages.length){var a=b("orderBy")(this.messages,"createdAt",!0)[0];return a.sender.firstName+" say's: "+a.content}}}}),c}),angular.module("nodegeeks-angular").factory("FileObj",function(a){var b=a.Model();return b.define("fileObj",{attributes:{path:{type:"string"},mime:{type:"string"},size:{type:"integer"}}}),b}),angular.module("nodegeeks-angular").factory("Issue",function(a){var b=a.Model();return b.define("issue",{attributes:{profile:{model:"Profile"},description:{type:"string"},status:{type:"string","enum":["closed","open","resolved"]},messages:{collection:"Message"}}}),b}),angular.module("nodegeeks-angular").factory("Message",function(a){var b=a.Model();return b.define("message",{attributes:{sender:{model:"profile"},content:{type:"string"},attachments:{collection:"fileObj"},conversation:{model:"conversation"},createdAt:{type:"string"},timeAgo:function(){return"11 seconds ago"},shortContent:function(){return this.content.length>49?this.content:this.content.substring(0,50)+"..."}}}),b}),angular.module("nodegeeks-angular").factory("Notification",function(a){var b=a.Model();return b.define("notification",{attributes:{subject:{type:"string"},type:{type:"string"},typeId:{type:"string"},timeAgo:function(){return"Earlier"},routePath:function(){switch(this.type){case"message":return"/dashboard/inbox/"+this.typeId;case"friend-request":return"/profile/"+this.typeId;case"comment-approval":return"/dashboard/article/"+this.typeId;default:return"/dashboard/inbox/notifications"}},content:{type:"string"},isUnread:{type:"boolean",defaultsTo:!0},profile:{model:"Profile"}}}),b}),angular.module("nodegeeks-angular").factory("Profile",function(a){var b=a.Model();return b.define("profile",{attributes:{firstName:{type:"string",required:!0},lastName:{type:"string",required:!0},name:function(){return this.firstName+" "+this.lastName},username:{type:"string"},email:{type:"email"},password:{type:"string"},token:{type:"string"},role:{type:"string","enum":["admin","moderator","billing","developer","member"],defaultsTo:"member"},image:{type:"string"},dob:{type:"date"},isActivated:{type:"boolean",defaultsTo:!1},notifications:{collection:"notification"},unreadNotifications:function(){return this.notifications.filter(function(a){return a.isUnread})},unreadConversations:function(){return this.conversations.filter(function(a){return a.isUnread})},conversations:{collection:"conversation"},socialProfiles:{collection:"social"},issues:{collection:"issue"}}}),b}),angular.module("nodegeeks-angular").factory("Social",function(a){var b=a.Model();return b.define("social",{attributes:{network:{type:"string"},profile:{model:"Profile"}}}),b}),angular.module("nodegeeks-angular").service("Auth",function(a,b,c,d,e,f,g){function h(){this.session=void 0,hello.on("auth.login",function(a){hello(a.network).api("/me").then(function(a){})})}return b.loginRedirect="/dashboard",b.logoutRedirect="/",h.prototype.login=function(h,i){var j=this;return f(function(f,k){d.request({method:"post",url:"/login",data:{login:h,password:i}},function(d){return 403==d.code||404==d.code?c.alert(d.message):d.isActivated?(e.setItem("session",d),j.session=b.session=a.Record(d),g.url(b.loginRedirect),void f(j.session)):c.alert("You need to activate your account before logging in.")},function(a){k(a)})})},h.prototype.logout=function(){var a=this;return f(function(d,f){a.session.token="",a.session.save().then(function(){a.session=b.session=void 0,e.removeItem("session"),g.url(b.logoutRedirect),d()},function(a){f(),c.alert(a.message)})})},h.prototype.validate=function(e){var f=this;d.request({method:"post",url:"/validate",data:{id:e.id,token:e.token}},function(c){f.session=b.session=a.Record(c),b.$apply()},function(a){c.alert(a.message)})},h.prototype.verify=function(a){this.login(this.session.email||this.session.username,a)},h.prototype.reset=function(e,f,g){d.request({method:"post",url:"/resetPassword",data:{id:e,hash:f,password:g}},function(c){_auth.session=b.session=a.Record(c),b.$apply()},function(a){c.alert(a.message)})},h.prototype.recover=function(a){d.request({method:"get",url:"/recoverPassword",data:{email:a}},function(a){alert(a.code)},function(a){c.alert(a.message)})},h.prototype.reset=function(a,b,e){return f(function(f,g){d.request({method:"post",url:"/resetPassword",data:{id:a,password:b,hash:e}},function(a){alert(a.code),f()},function(a){g(),c.alert(a.message)})})},h.prototype.signup=function(b){return f(function(d,e){a.create(b).then(function(b){c.alert("Activation email has been sent, check your email and active your account before logging in."),d(a.Record(b))},function(a){e(),c.alert(a.message)})})},h.prototype.social=function(a){hello(a).login()},new h}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},angular.module("nodegeeks-angular").service("DS",function(a,b,c,d){function e(){this.database={},this._models=[]}return e.prototype.Model=function(){function a(){this.modelName=void 0,this.attributes={},this._watch=!1}var e=this;return a.prototype.Record=function(a){function f(){var f=this;Object.defineProperty(this,"_model",{writable:!1,value:g,enumerable:!1,configurable:!1}),Object.defineProperty(this,"isDirty",{writable:!0,value:!1,enumerable:!1,configurable:!0});for(var h in g.attributes)if("function"==typeof g.attributes[h])Object.defineProperty(this,h,{get:g.attributes[h],enumerable:!1,configurable:!1});else if(g.attributes[h]&&g.attributes[h].model){var i=null;if(e._models.forEach(function(a){a.modelName==g.attributes[h].model&&(i=a)}),!i){var j=d.has(g.attributes[h].model.capitalize());if(!j)return console.error({message:"The `"+g.attributes[h].model+"` model service you are attempting to use does not exist.",code:"NO_MODEL_FOUND"});i=d.get(g.attributes[h].model.capitalize())}var k=function(){var b=this;return Object.defineProperty(this,"_model",{writable:!1,value:i,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_property",{writable:!1,value:h,enumerable:!1,configurable:!1}),a[this._property]&&a[this._property].constructor==Object?angular.extend(b,b._model.Record(a[this._property])):void(a[this._property]&&(b.id=a[this._property],b.get().then(function(a){return angular.extend(b,a)})))};k.prototype=Object.create(Object.prototype),k.prototype.get=function(){var a=this;return b(function(b,c){return a._model.findOne(a.id).then(function(c){b(a._model.Record(c))})})},Object.defineProperty(this,h,{writable:!0,value:new k,enumerable:!0,configurable:!0})}else if(g.attributes[h]&&g.attributes[h].collection){var i=null;if(e._models.forEach(function(a){a.modelName==g.attributes[h].collection&&(i=a)}),!i){var j=d.has(g.attributes[h].collection.capitalize());if(!j)return console.error({message:"The `"+g.attributes[h].collection+"` model service you are attempting to use does not exist.",code:"NO_MODEL_FOUND"});i=d.get(g.attributes[h].collection.capitalize())}var l=function(){var b=this;Object.defineProperty(this,"_model",{writable:!1,value:i,enumerable:!1,configurable:!1}),Object.defineProperty(this,"_property",{writable:!1,value:h,enumerable:!1,configurable:!1}),a[this._property]&&a[this._property].length&&a[this._property].forEach(function(a){return a.constructor==Object?b.push(b._model.Record(a)):g.findOne(a).then(function(a){b.push(b._model.Record(a))})})};l.prototype=Object.create(Array.prototype),l.prototype.remove=function(a){var d=this;return b(function(b,e){if(a.constructor==Array)return console.error({message:"You passed an `array`, only objects, strings and integer datatypes allowed.",code:"INVALID_DATATYPE"});if(a.constructor==Object){if(!a.id)return e({error:"No `id` was found for the relationship record you passed",code:"MISSING_ID"});c.request({method:"delete",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){return c.error?e(c):(d.forEach(function(b){if(b.id==a.id){var c=d.indexOf(a);d.splice(c,1)}}),b(d._model.Record(c)))},function(a){return console.error(a),e(a)})}else c.request({method:"delete",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a},function(c){return c.error?e(c):(d.forEach(function(b){if(b.id==a){var c=d.indexOf(a);d.splice(c,1)}}),b(d._model.Record(c)))},function(a){return console.error(a),e(a)})})},l.prototype.add=function(a){var d=this;return b(function(b,e){return a.constructor==Array?console.error({message:"You passed an `array`, only objects, strings and integer datatypes allowed.",code:"INVALID_DATATYPE"}):void(a.constructor==Object?a.id?c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){if(c.error)return e(c);var f=c[d._property].indexOf(a),g=d._model.Record(c[d._property][f]);return d.push(g),b(g)},function(a){return console.error(a),e(a)}):d._model.create(a).then(function(a){c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a.id},function(c){if(c.error)return e(c);var f=null;return c[d._property].forEach(function(b){b.id==a.id&&(f=d._model.Record(b))}),d.push(f),b(f)},function(a){return console.error(a),e(a)})},function(a){console.error(a)}):c.request({method:"post",url:"/"+g.modelName+"/"+f.id+"/"+d._property+"/"+a},function(c){if(c.error)return e(c);var f=c[d._property].indexOf(a),g=d._model.Record(c[d._property][f]);return d.push(g),b(g)},function(a){return console.error(a),e(a)}))})},l.prototype.get=function(){var a=this;return b(function(b,c){a.forEach(function(c,d){return c.retrieve().then(function(b){a[d]=b},function(){}),d==a.length-1?b(a):void 0})})},Object.defineProperty(this,h,{writable:!0,value:new l,enumerable:!0,configurable:!0})}else Object.defineProperty(this,h,{writable:!0,value:a[h],enumerable:!0,configurable:!0})}var g=this;if(e.database[g.modelName][a.id])return e.database[g.modelName][a.id];f.prototype.destroy=function(){var a=this;return b(function(b,c){a._model["delete"](a.id).then(function(a){return e.database[g.modelName].removeItem(a.id),b(a)},function(a){return console.error(a),c(a)})})},f.prototype.retrieve=function(){var c=this;return b(function(b,d){c._model.findOne(c.id).then(function(c){return e.database[g.modelName][a.id]=c,b(c)},function(a){return console.error(a),d(a)})})},f.prototype.save=function(a,c){var d=this,e={};for(var f in this)this.hasOwnProperty(f)&&"function"!=typeof this[f]&&"__proto__"!==f&&"isDirty"!==f&&"updatedAt"!==f&&"_model"!==f&&"_data"!==f&&"id"!==f&&(e[f]=this[f]);return b(function(a,b){g.update(d.id,e).then(function(b){return a(b)})})};var h=new f;return h},a.prototype.define=function(a,b){var d=this;this.modelName=a,angular.extend(this,b),this.attributes.id=null,e.database[a]={},c.on(a,function(a){d.modelName;console.log(a)}),e._models.push(this)},a.prototype.create=function(a){var d=this;return b(function(b,f){for(var g in d.attributes)if(d.attributes.hasOwnProperty(g)&&!a[g]&&(d.attributes[g]&&d.attributes[g].defaultsTo&&(a[g]=d.attributes[g].defaultsTo),d.attributes[g]&&d.attributes[g].required))return f({message:"`"+g+"` is a required attribute"});for(var h in a)if(a.hasOwnProperty(h))if(!d.attributes[h]||d.attributes[h].collection||d.attributes[h].model)d.attributes[h]&&d.attributes[h].collection&&a[h].length,d.attributes[h]&&d.attributes[h].model&&("string"==typeof a[h]||"number"==typeof a[h]);else if("email"==d.attributes[h].type){var i=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);if(!i.test(a[h]))return f({message:"`"+h+"` needs to be a valid email"})}else if(typeof a[h]!==d.attributes[h].type)return f({message:"the value of "+h+" must be a "+d.attributes[h].type+" datatype"});c.request({method:"post",url:"/"+d.modelName,data:a},function(a){if(a.error){var c={};if("E_VALIDATION"==a.error)for(var g in a.invalidAttributes)if(a.invalidAttributes.hasOwnProperty(g))return c.message=a.invalidAttributes[g][0].message,c.code="UNIQUE",console.error(c),f(c);return f(a)}if(a.id){var h=d.Record(a);return e.database[d.modelName][a.id]=h,b(h)}},function(a){return console.error(a),f(a)})})},a.prototype.findOne=function(a){var d=this;return b(function(b,f){if(!a){var g={message:"Must pass the `id` parameter to the `findOne` method",code:"MISSING_PARAM"};return console.error(g),f(g)}c.request({method:"get",url:"/"+d.modelName+"/"+a},function(a){if("string"==typeof a)return f({message:a});var c=d.Record(a);return e.database[d.modelName][a.id]=c,a?b(c):void 0},function(a){return console.error(a),f(a)})})},a.prototype.findAll=function(a){var d=this,f="";return b(function(b,g){if(a){if("number"!=typeof a)return g({message:"must pass an integer",code:"INVALID_PARAM_PASSED"});f="?limit="+a}c.request({method:"get",url:"/"+d.modelName+f},function(a){if(a.length){var c=[];return a.forEach(function(a){var b=d.Record(a);e.database[d.modelName][a.id]=b,c.push(b)}),b(c)}return g({message:"No records found for `"+d.modelName+"`",code:"NO_RECORDS"})})})},a.prototype.query=function(a){var d=this,f="",g=!1;for(var h in a)a.hasOwnProperty(h)&&(g?f=f+"&"+h+"="+a[h]:(f=f+h+"="+a[h],g=!0));return b(function(a,b){c.request({method:"get",url:"/"+d.modelName+"?"+f},function(c){if(c.length){var f=[];return c.forEach(function(a){var b=d.Record(a);e.database[d.modelName][a.id]=b,f.push(b)}),a(f)}return b({message:"No records found for `"+d.modelName+"`",code:"NO_RECORDS"})})})},a.prototype["delete"]=function(a){var d=this;return b(function(b,f){c.request({method:"delete",url:"/"+d.modelName+"/"+a},function(a){return delete e.database[d.modelName][a.id],a?b(a):void 0},function(a){return console.error(a),f(a)})})},a.prototype.update=function(a,d){var f=this;return b(function(b,g){c.request({method:"put",data:d,url:"/"+f.modelName+"/"+a},function(a){var c=f.Record(a);return e.database[f.modelName][a.id]=c,a?b(c):void 0},function(a){return console.error(a),g(a)})})},new a},new e}),angular.module("nodegeeks-angular").service("LocalStorage",function(){return{getItem:function(a){var b=localStorage.getItem(a),c=JSON.parse(b);return c?c:b},setItem:function(a,b){return b.constructor==Object||b.constructor==Array?localStorage.setItem(a,JSON.stringify(b)):b.constructor==Function?console.error("Cannot set a function as a value"):localStorage.setItem(a,b)},removeItem:function(a){return localStorage.removeItem(a)}}}),angular.module("nodegeeks-angular").service("Notify",function(a,b){function c(){}return c.prototype.alert=function(a,b){alert(a)},new c}),angular.module("nodegeeks-angular").factory("settings",function(a){var b={layout:{pageSidebarClosed:!1,pageContentWhite:!0,pageBodySolid:!1,pageAutoScrollOnLoad:1e3},assetsPath:"assets",globalPath:"assets/global",layoutPath:"assets/layouts/layout4"};return a.settings=b,b});